APP_ENV=local
LOG_LEVEL=INFO

# Lab-only auth toggle for payments-api (disable for quick local demos).
# For internet-facing demos, enable and set a strong token.
API_AUTH_ENABLED=false
API_AUTH_TOKEN=replace-with-strong-random-token

POSTGRES_DSN=postgresql+asyncpg://postgres:postgres@localhost:5432/payments
REDIS_URL=redis://localhost:6379/0
CORS_ALLOWED_ORIGINS_CSV=http://localhost:3000,http://127.0.0.1:3000,http://localhost:8080,http://127.0.0.1:8080

# Processor provider URL resolution:
# 1) PROVIDER_MOCK_BASE_URL (if set) has highest priority
# 2) Otherwise uses <scheme>://<host>, where:
#    - APP_ENV=local -> LOCAL_PROVIDER_SCHEME (default http)
#    - APP_ENV!=local -> SECURE_PROVIDER_SCHEME (default https)
PROVIDER_MOCK_BASE_URL=
PROVIDER_MOCK_HOST=provider-mock:8082
LOCAL_PROVIDER_SCHEME=http
SECURE_PROVIDER_SCHEME=https

# Optional domain-event fan-out bus (payments-processor):
# - none: keep queue publishing disabled (default)
# - rabbitmq: publish PaymentReviewRequired/Confirmed/Failed outbox events to RabbitMQ topic exchange
EVENT_BUS_BACKEND=none
EVENT_BUS_URL=amqp://lab_rabbit_user:change-this-password@localhost:5672/
EVENT_BUS_EXCHANGE=payments.events
EVENT_BUS_ROUTING_PREFIX=payments
EVENT_BUS_KAFKA_BOOTSTRAP_SERVERS=localhost:19092
EVENT_BUS_KAFKA_TOPIC=payments.domain-events

OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf

# Observability console credentials for local-only environment.
GRAFANA_ADMIN_USER=grafana_admin
GRAFANA_ADMIN_PASSWORD=change-this-password
RABBITMQ_DEFAULT_USER=lab_rabbit_user
RABBITMQ_DEFAULT_PASS=change-this-password

# Rate limits
MERCHANT_RATE_LIMIT=120
CUSTOMER_RATE_LIMIT=80
ACCOUNT_RATE_LIMIT=80
RATE_LIMIT_WINDOW_SECONDS=60

# AML
AML_TOTAL_WINDOW_SECONDS=600
AML_TOTAL_THRESHOLD_AMOUNT=5000
AML_STRUCTURING_WINDOW_SECONDS=900
AML_STRUCTURING_COUNT_THRESHOLD=3
AML_BLOCKLIST_DESTINATIONS_CSV=dest-blocked-001,dest-blocked-002

# Provider mock fault injection
RANDOM_SEED=42
FAULT_5XX_RATE=0.05
TIMEOUT_RATE=0.03
LATENCY_SPIKE_RATE=0.10
DUPLICATE_RATE=0.02
PARTIAL_FAILURE_RATE=0.04
